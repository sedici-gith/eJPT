## Host & Network Penetration Testing: Network-Based Attacks CTF 1

### Flag 1: What is the URL accessed by the infected user that returned a 200 OK response code.

We can find test.pcap on attack machine desktop. Open it using Wireshark.
We can isolate HTTP packets filter gin by HTTP protocol:
```
_ws.col.protocol == "HTTP"
```
We need the packet number 1357 and its HTTP GET Header.
```
http://623start.site/?status=start&av=Windows%20Defender
```
The answer is
```
623start.site
```
### Flag 2: What is the IP address, MAC address of the infected Windows client?

Whitin the same packet, in the ethernet info, we can find the MAC address of the infected machine. In the IP section we can find the IP address.

The correct answer is 
```
10.7.10.47, 80:86:5b:ab:1e:c4
```
### Flag 3: Which Wireshark filter can you use to determine the victim’s hostname from NetBIOS Name Service traffic, and what is the detected hostname for this malware infection?
```
nbns
```
This filter identifies the NETBios packets. After some analysis we are able to find the computer name.
```
nbns ,DESKTOP-9PEA63H
```
### Flag 4: Which user got infected and ran the mystery_file.ps1 PowerShell script?

Using CTRL+F combination and selecting “Packet Bytes” and “String” as filters, we can search for mystery_file.ps1.

Coping the right box content as a “Printable Text”, we paste it into a text editor to begin the enumeration searching for a username.

We find the correct answer is:
```
rwalters
```
### Flag 5: What User-Agent string indicates the traffic generated by a PowerShell script?

Analyzing the same packet 1357, we can easily identify the user-agent as:
```
Mozilla/5.0 (Windows NT; Windows NT 10.0; en-US) WindowsPowerShell/5.1.19041.3031
```
The correct answer is:
```
WindowsPowerShell
```
### Flag 6: Which wallet extension ID is associated with the Coinbase wallet?

As we have done for flag ,4 we can search for “Coinbase”.
Right-click on the found packet and select “Follow TCP Stream”.
Searching again for Coinbase, we find:
```
hnfanknocfeofbddgcijnmhnfnkdnaad|Coinbase
```
and the correct answer is:
```
hnfanknocfeofbddgcijnmhnfnkdnaad
```
